Fixed an issue where ``syntax-error`` couldn't be raised on files with invalid encodings.

Closes #7522
